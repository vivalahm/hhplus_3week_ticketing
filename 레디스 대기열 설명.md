### 토큰 대기열 관리 전략

<img width="1903" alt="image" src="https://github.com/user-attachments/assets/f5311ee4-1473-4103-8310-e0a34743657d">

1. 사용자에게 토큰을 발급하면 중복발급인지 먼저 체크
2. 사용자가 최대 최대 액티브 토큰이 현재 액티브된 토큰 보다 적고 웨이팅 토큰이 없을때 사용자는 active 큐에 저장되고 token의 상태를 Active로 해서 저장 이때 TTL은 10분을 준다.
3. 반대일경우 Waiting 큐에 추가하고 토큰의 상태를 Wating으로 만듬. 그리고 해당 토큰은 별도의 TTL없이 기다림( 물론 TTL 줄수는 있는데, 혹시 몰라 안줬습니다.)
4. 스케줄러가 액티브 큐에 있는 목록들을 가져와서 토큰value를 통해 토큰이 살아있는지 확인합니다.TTL이 만료되었으면 제거하기 위해
5. 토큰이 없다면 액티브 큐에서 해당 토큰을 제거해주고 액티브 큐로 넣어주면서 토큰의 상태값은 Active로 만들어주고 TTL은 10분을 부여합니다.

![image-20240802114409913](https://raw.githubusercontent.com/vivalahm/img/master/uPic/image-20240802114409913.png?token=ALT3VFXA34NDSQQZEBWXROTGVREDO)

![image-20240802114400495](https://raw.githubusercontent.com/vivalahm/img/master/uPic/image-20240802114400495.png?token=ALT3VFXB57NOZRLOPYPD4YLGVREC4)